<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="book.css" type="text/css" />
</head>
<body>
<h2 id="argparse---&#21629;&#20196;&#34892;&#36873;&#39033;&#19982;&#21442;&#25968;&#35299;&#26512;&#35793;">argparse - &#21629;&#20196;&#34892;&#36873;&#39033;&#19982;&#21442;&#25968;&#35299;&#26512;&#65288;&#35793;&#65289;</h2>
<p>2013-03-30 &#20845; By youngsterxyf</p>
<p>&#21407;&#25991;&#65306;argparse &#8211; Command line option and argument parsing</p>
<p>&#35793;&#32773;&#65306;youngsterxyf</p>
<p>&#32593;&#22336;&#65306;http://blog.xiayf.cn/2013/03/30/argparse/</p>
<p><code>argparse</code>&#27169;&#22359;&#20316;&#20026;<code>optparse</code>&#30340;&#19968;&#20010;&#26367;&#20195;&#34987;&#28155;&#21152;&#21040;Python2.7&#12290;<code>argparse</code>&#30340;&#23454;&#29616;&#25903;&#25345;&#19968;&#20123;&#19981;&#26131;&#20110;&#28155;&#21152;&#21040;<code>optparse</code>&#20197;&#21450;&#35201;&#27714;&#21521;&#21518;&#19981;&#20860;&#23481;API&#21464;&#21270;&#30340;&#29305;&#24615;&#65292;&#22240;&#27492;&#20197;&#19968;&#20010;&#26032;&#27169;&#22359;&#28155;&#21152;&#21040;&#26631;&#20934;&#24211;&#12290;</p>
<h3 id="&#19982;optparse&#30456;&#27604;&#36739;">&#19982;optparse&#30456;&#27604;&#36739;</h3>
<p>argparse&#30340;API&#31867;&#20284;&#20110;optparse&#65292;&#29978;&#33267;&#22312;&#24456;&#22810;&#24773;&#20917;&#19979;&#36890;&#36807;&#26356;&#26032;&#25152;&#20351;&#29992;&#30340;&#31867;&#21517;&#21644;&#26041;&#27861;&#21517;&#65292;&#20351;&#29992;argparse&#20316;&#20026;&#19968;&#20010;&#31616;&#21333;&#30340;&#26367;&#20195;&#12290;&#28982;&#32780;&#65292;&#26377;&#20123;&#22320;&#26041;&#22312;&#28155;&#21152;&#26032;&#29305;&#24615;&#26102;&#19981;&#33021;&#20445;&#25345;&#30452;&#25509;&#20860;&#23481;&#24615;&#12290;</p>
<p>&#20320;&#24517;&#39035;&#35270;&#24773;&#20917;&#20915;&#23450;&#26159;&#21542;&#21319;&#32423;&#24050;&#26377;&#30340;&#31243;&#24207;&#12290;&#22914;&#26524;&#20320;&#24050;&#32534;&#20889;&#20102;&#39069;&#22806;&#30340;&#20195;&#30721;&#20197;&#24357;&#34917;optparse&#30340;&#23616;&#38480;&#65292;&#20063;&#35768;&#20320;&#24819;&#21319;&#32423;&#31243;&#24207;&#20197;&#20943;&#23569;&#20320;&#38656;&#35201;&#32500;&#25252;&#30340;&#20195;&#30721;&#37327;&#12290;&#33509;argparse&#22312;&#25152;&#26377;&#37096;&#32626;&#24179;&#21488;&#19978;&#37117;&#21487;&#29992;&#65292;&#37027;&#20040;&#26032;&#30340;&#31243;&#24207;&#24212;&#23613;&#21487;&#33021;&#20351;&#29992;argparse&#12290;</p>
<h3 id="&#35774;&#32622;&#19968;&#20010;&#35299;&#26512;&#22120;">1. &#35774;&#32622;&#19968;&#20010;&#35299;&#26512;&#22120;</h3>
<p>&#20351;&#29992;argparse&#30340;&#31532;&#19968;&#27493;&#23601;&#26159;&#21019;&#24314;&#19968;&#20010;<strong>&#35299;&#26512;&#22120;&#23545;&#35937;</strong>&#65292;&#24182;&#21578;&#35785;&#23427;&#23558;&#20250;&#26377;&#20123;&#20160;&#20040;&#21442;&#25968;&#12290;&#37027;&#20040;&#24403;&#20320;&#30340;&#31243;&#24207;&#36816;&#34892;&#26102;&#65292;&#35813;&#35299;&#26512;&#22120;&#23601;&#21487;&#20197;&#29992;&#20110;&#22788;&#29702;&#21629;&#20196;&#34892;&#21442;&#25968;&#12290;</p>
<p>&#35299;&#26512;&#22120;&#31867;&#26159;<code>ArgumentParser</code>&#12290;&#26500;&#36896;&#26041;&#27861;&#25509;&#25910;&#20960;&#20010;&#21442;&#25968;&#26469;&#35774;&#32622;&#29992;&#20110;&#31243;&#24207;&#24110;&#21161;&#25991;&#26412;&#30340;&#25551;&#36848;&#20449;&#24687;&#20197;&#21450;&#20854;&#20182;&#20840;&#23616;&#30340;&#34892;&#20026;&#25110;&#35774;&#32622;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse
parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;This is a PyMOTW sample program&#39;</span>)</code></pre></div>
<h3 id="&#23450;&#20041;&#21442;&#25968;">2. &#23450;&#20041;&#21442;&#25968;</h3>
<p>argparse&#26159;&#19968;&#20010;&#20840;&#38754;&#30340;&#21442;&#25968;&#22788;&#29702;&#24211;&#12290;&#21442;&#25968;&#21487;&#20197;&#35302;&#21457;&#19981;&#21516;&#30340;&#21160;&#20316;&#65292;&#21160;&#20316;&#30001; <code>add_argument()</code> &#26041;&#27861;&#30340; <code>action</code> &#21442;&#25968;&#25351;&#23450;&#12290; &#25903;&#25345;&#30340;&#21160;&#20316;&#21253;&#25324;&#20445;&#23384;&#21442;&#25968;&#65288;&#36880;&#20010;&#22320;&#65292;&#25110;&#32773;&#20316;&#20026;&#21015;&#34920;&#30340;&#19968;&#37096;&#20998;&#65289;&#65292;&#24403;&#35299;&#26512;&#21040;&#26576;&#21442;&#25968;&#26102;&#20445;&#23384;&#19968;&#20010;&#24120;&#37327;&#20540;&#65288;&#21253;&#25324;&#23545;&#24067;&#23572;&#24320;&#20851;&#30495;/&#20551;&#20540;&#30340;&#29305;&#27530;&#22788;&#29702;&#65289;&#65292;&#32479;&#35745;&#26576;&#20010;&#21442;&#25968;&#20986;&#29616;&#30340;&#27425;&#25968;&#65292;&#20197;&#21450;&#35843;&#29992;&#19968;&#20010;&#22238;&#35843;&#20989;&#25968;&#12290;</p>
<p>&#40664;&#35748;&#30340;&#21160;&#20316;&#26159;&#20445;&#23384;&#21442;&#25968;&#20540;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#22914;&#26524;&#25552;&#20379;&#19968;&#20010;&#31867;&#22411;&#65292;&#37027;&#20040;&#22312;&#23384;&#20648;&#20043;&#21069;&#20250;&#20808;&#25226;&#35813;&#21442;&#25968;&#20540;&#36716;&#25442;&#25104;&#35813;&#31867;&#22411;&#12290;&#22914;&#26524;&#25552;&#20379; dest &#21442;&#25968;&#65292;&#21442;&#25968;&#20540;&#23601;&#20445;&#23384;&#20026;&#21629;&#20196;&#34892;&#21442;&#25968;&#35299;&#26512;&#26102;&#36820;&#22238;&#30340;&#21629;&#21517;&#31354;&#38388;&#23545;&#35937;&#20013;&#21517;&#20026;&#35813; dest &#21442;&#25968;&#20540;&#30340;&#19968;&#20010;&#23646;&#24615;&#12290; &#35299;&#26512;&#19968;&#20010;&#21629;&#20196;&#34892;</p>
<p>&#23450;&#20041;&#20102;&#25152;&#26377;&#21442;&#25968;&#20043;&#21518;&#65292;&#20320;&#23601;&#21487;&#20197;&#32473;<code>parse_args()</code>&#20256;&#36882;&#19968;&#32452;&#21442;&#25968;&#23383;&#31526;&#20018;&#26469;&#35299;&#26512;&#21629;&#20196;&#34892;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#21442;&#25968;&#26159;&#20174; <code>sys.argv[1:]</code> &#20013;&#33719;&#21462;&#65292;&#20294;&#20320;&#20063;&#21487;&#20197;&#20256;&#36882;&#33258;&#24049;&#30340;&#21442;&#25968;&#21015;&#34920;&#12290;&#36873;&#39033;&#26159;&#20351;&#29992;GNU/POSIX&#35821;&#27861;&#26469;&#22788;&#29702;&#30340;&#65292;&#25152;&#20197;&#22312;&#24207;&#21015;&#20013;&#36873;&#39033;&#21644;&#21442;&#25968;&#20540;&#21487;&#20197;&#28151;&#21512;&#12290;</p>
<p><code>parse_args()</code> &#30340;&#36820;&#22238;&#20540;&#26159;&#19968;&#20010;&#21629;&#21517;&#31354;&#38388;&#65292;&#21253;&#21547;&#20256;&#36882;&#32473;&#21629;&#20196;&#30340;&#21442;&#25968;&#12290;&#35813;&#23545;&#35937;&#23558;&#21442;&#25968;&#20445;&#23384;&#20854;&#23646;&#24615;&#65292;&#22240;&#27492;&#22914;&#26524;&#20320;&#30340;&#21442;&#25968;<code>dest</code>&#26159; &quot;myoption&quot;&#65292;&#37027;&#20040;&#20320;&#23601;&#21487;&#20197;<code>args.myoption</code> &#26469;&#35775;&#38382;&#35813;&#20540;&#12290;</p>
<h3 id="&#31616;&#21333;&#31034;&#20363;">3. &#31616;&#21333;&#31034;&#20363;</h3>
<p>&#20197;&#19979;&#31616;&#21333;&#31034;&#20363;&#24102;&#26377;3&#20010;&#19981;&#21516;&#30340;&#36873;&#39033;&#65306;&#19968;&#20010;&#24067;&#23572;&#36873;&#39033;&#65288;-a&#65289;&#65292;&#19968;&#20010;&#31616;&#21333;&#30340;&#23383;&#31526;&#20018;&#36873;&#39033;&#65288;-b&#65289;&#65292;&#20197;&#21450;&#19968;&#20010;&#25972;&#25968;&#36873;&#39033;&#65288;-c&#65289;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Short sample app&#39;</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;b&quot;</span>)
parser.add_argument(<span class="st">&#39;-c&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;c&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)

<span class="bu">print</span> parser.parse_args([<span class="st">&#39;-a&#39;</span>, <span class="st">&#39;-bval&#39;</span>, <span class="st">&#39;-c&#39;</span>, <span class="st">&#39;3&#39;</span>])</code></pre></div>
<p>&#26377;&#20960;&#31181;&#26041;&#24335;&#20256;&#36882;&#20540;&#32473;&#21333;&#23383;&#31526;&#36873;&#39033;&#12290;&#20197;&#19978;&#20363;&#23376;&#20351;&#29992;&#20102;&#20004;&#31181;&#19981;&#21516;&#30340;&#24418;&#24335;&#65292;<code>-bval</code> &#21644;<code>-c val</code>&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_short.py
<span class="kw">Namespace</span>(a=True, b=<span class="st">&#39;val&#39;</span>, c=3)</code></pre></div>
<p>&#22312;&#36755;&#20986;&#20013;&#19982;<code>'c'</code>&#20851;&#32852;&#30340;&#20540;&#26159;&#19968;&#20010;&#25972;&#25968;&#65292;&#22240;&#20026;&#31243;&#24207;&#21578;&#35785;<code>ArgumentParser</code>&#22312;&#20445;&#23384;&#20043;&#21069;&#20808;&#36716;&#25442;&#35813;&#21442;&#25968;&#12290;</p>
<p>&#8220;&#38271;&#8221;&#36873;&#39033;&#21517;&#23383;&#65292;&#21363;&#36873;&#39033;&#30340;&#21517;&#23383;&#22810;&#20110;&#19968;&#20010;&#23383;&#31526;&#65292;&#20197;&#30456;&#21516;&#30340;&#26041;&#24335;&#36827;&#34892;&#22788;&#29702;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Example with long option names&#39;</span>)

parser.add_argument(<span class="st">&#39;--noarg&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;--witharg&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;witharg&quot;</span>)
parser.add_argument(<span class="st">&#39;--witharg2&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;witharg2&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)

<span class="bu">print</span> parser.parse_args([<span class="st">&#39;--noarg&#39;</span>, <span class="st">&#39;--witharg&#39;</span>, <span class="st">&#39;val&#39;</span>, <span class="st">&#39;--withargs=3&#39;</span>])</code></pre></div>
<p>&#32467;&#26524;&#20063;&#31867;&#20284;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_long.py
<span class="kw">Namespace</span>(noarg=True, witharg=<span class="st">&#39;val&#39;</span>, witharg2=3)</code></pre></div>
<p><code>argparse</code>&#21306;&#21035;&#20110;<code>optparse</code>&#30340;&#19968;&#20010;&#22320;&#26041;&#26159;&#23545;<strong>&#38750;&#36873;&#39033;&#21442;&#25968;&#20540;</strong>&#30340;&#22788;&#29702;&#12290;optparse&#21482;&#36827;&#34892;&#36873;&#39033;&#35299;&#26512;&#65292;&#32780;argparse&#26159;&#19968;&#20010;&#20840;&#38754;&#30340;&#21629;&#20196;&#34892;&#21442;&#25968;&#35299;&#26512;&#24037;&#20855;&#65292;&#20063;&#22788;&#29702;&#38750;&#36873;&#39033;&#21442;&#25968;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Example with non-optional arguments&#39;</span>)

parser.add_argument(<span class="st">&#39;count&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)
parser.add_argument(<span class="st">&#39;units&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#8220;count&#8221;&#21442;&#25968;&#26159;&#19968;&#20010;&#25972;&#25968;&#65292;&#8220;units&#8221;&#21442;&#25968;&#23384;&#20648;&#20026;&#19968;&#20010;&#23383;&#31526;&#20018;&#12290;&#20854;&#20013;&#20219;&#24847;&#19968;&#20010;&#21442;&#25968;&#33509;&#27809;&#26377;&#22312;&#21629;&#20196;&#34892;&#20013;&#25552;&#20379;&#65292;&#25110;&#32473;&#23450;&#30340;&#20540;&#19981;&#33021;&#34987;&#36716;&#25442;&#20026;&#27491;&#30830;&#30340;&#31867;&#22411;&#65292;&#23601;&#20250;&#25253;&#21578;&#19968;&#20010;&#38169;&#35823;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_arguments.py 3 inches

<span class="kw">Namespace</span>(count=3, units=<span class="st">&#39;inches&#39;</span>)

$ <span class="kw">python</span> argparse_arguments.py some inches

<span class="kw">usage</span>: argparse_arguments.py [-h] count units
<span class="kw">argparse_arguments.py</span>: error: argument count: invalid int value: <span class="st">&#39;some&#39;</span>

$ <span class="kw">python</span> argparse_arguments.py

<span class="kw">usage</span>: argparse_arguments.py [-h] count units
<span class="kw">argparse_arguments.py</span>: error: too few arguments</code></pre></div>
<h3 id="&#21442;&#25968;&#21160;&#20316;">4. &#21442;&#25968;&#21160;&#20316;</h3>
<p><code>argparse</code>&#20869;&#32622;6&#31181;&#21160;&#20316;&#21487;&#20197;&#22312;&#35299;&#26512;&#21040;&#19968;&#20010;&#21442;&#25968;&#26102;&#36827;&#34892;&#35302;&#21457;&#65306;</p>
<ul>
<li><p><code>store</code> &#20445;&#23384;&#21442;&#25968;&#20540;&#65292;&#21487;&#33021;&#20250;&#20808;&#23558;&#21442;&#25968;&#20540;&#36716;&#25442;&#25104;&#21478;&#19968;&#20010;&#25968;&#25454;&#31867;&#22411;&#12290;&#33509;&#27809;&#26377;&#26174;&#24335;&#25351;&#23450;&#21160;&#20316;&#65292;&#21017;&#40664;&#35748;&#20026;&#35813;&#21160;&#20316;&#12290;</p></li>
<li><p><code>store_const</code> &#20445;&#23384;&#19968;&#20010;&#34987;&#23450;&#20041;&#20026;&#21442;&#25968;&#35268;&#26684;&#19968;&#37096;&#20998;&#30340;&#20540;&#65292;&#32780;&#19981;&#26159;&#19968;&#20010;&#26469;&#33258;&#21442;&#25968;&#35299;&#26512;&#32780;&#26469;&#30340;&#20540;&#12290;&#36825;&#36890;&#24120;&#29992;&#20110;&#23454;&#29616;&#38750;&#24067;&#23572;&#20540;&#30340;&#21629;&#20196;&#34892;&#26631;&#35760;&#12290;</p></li>
<li><p><code>store_ture/store_false</code> &#20445;&#23384;&#30456;&#24212;&#30340;&#24067;&#23572;&#20540;&#12290;&#36825;&#20004;&#20010;&#21160;&#20316;&#34987;&#29992;&#20110;&#23454;&#29616;&#24067;&#23572;&#24320;&#20851;&#12290;</p></li>
<li><p><code>append</code> &#23558;&#20540;&#20445;&#23384;&#21040;&#19968;&#20010;&#21015;&#34920;&#20013;&#12290;&#33509;&#21442;&#25968;&#37325;&#22797;&#20986;&#29616;&#65292;&#21017;&#20445;&#23384;&#22810;&#20010;&#20540;&#12290;</p></li>
<li><p><code>append_const</code> &#23558;&#19968;&#20010;&#23450;&#20041;&#22312;&#21442;&#25968;&#35268;&#26684;&#20013;&#30340;&#20540;&#20445;&#23384;&#21040;&#19968;&#20010;&#21015;&#34920;&#20013;&#12290;</p></li>
<li><p><code>version</code> &#25171;&#21360;&#20851;&#20110;&#31243;&#24207;&#30340;&#29256;&#26412;&#20449;&#24687;&#65292;&#28982;&#21518;&#36864;&#20986;</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser()

parser.add_argument(<span class="st">&#39;-s&#39;</span>, action<span class="op">=</span><span class="st">&#39;store&#39;</span>, dest<span class="op">=</span><span class="st">&#39;simple_value&#39;</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Store a simple value&#39;</span>)

parser.add_argument(<span class="st">&#39;-c&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_const&#39;</span>, dest<span class="op">=</span><span class="st">&#39;constant_value&#39;</span>,
        const<span class="op">=</span><span class="st">&#39;value-to-store&#39;</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Store a constant value&#39;</span>)

parser.add_argument(<span class="st">&#39;-t&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, default<span class="op">=</span><span class="va">False</span>,
        dest<span class="op">=</span><span class="st">&#39;boolean_switch&#39;</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Set a switch to true&#39;</span>)
parser.add_argument(<span class="st">&#39;-f&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_false&#39;</span>, default<span class="op">=</span><span class="va">False</span>,
        dest<span class="op">=</span><span class="st">&#39;boolean_switch&#39;</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Set a switch to false&#39;</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&#39;append&#39;</span>, dest<span class="op">=</span><span class="st">&#39;collection&#39;</span>,
        default<span class="op">=</span>[],
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Add repeated values to a list&#39;</span>)

parser.add_argument(<span class="st">&#39;-A&#39;</span>, action<span class="op">=</span><span class="st">&#39;append_const&#39;</span>, dest<span class="op">=</span><span class="st">&#39;const_collection&#39;</span>,
        const<span class="op">=</span><span class="st">&#39;value-1-to-append&#39;</span>,
        default<span class="op">=</span>[],
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Add different values to list&#39;</span>)
parser.add_argument(<span class="st">&#39;-B&#39;</span>, action<span class="op">=</span><span class="st">&#39;append_const&#39;</span>, dest<span class="op">=</span><span class="st">&#39;const_collection&#39;</span>,
        const<span class="op">=</span><span class="st">&#39;value-2-to-append&#39;</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Add different values to list&#39;</span>)

parser.add_argument(<span class="st">&#39;--version&#39;</span>, action<span class="op">=</span><span class="st">&#39;version&#39;</span>, version<span class="op">=</span><span class="st">&#39;</span><span class="sc">%(prog)s</span><span class="st"> 1.0&#39;</span>)

results <span class="op">=</span> parser.parse_args()
<span class="bu">print</span> <span class="st">&#39;simple_value     =&#39;</span>, results.simple_value
<span class="bu">print</span> <span class="st">&#39;constant_value   =&#39;</span>, results.constant_value
<span class="bu">print</span> <span class="st">&#39;boolean_switch   =&#39;</span>, results.boolean_switch
<span class="bu">print</span> <span class="st">&#39;collection       =&#39;</span>, results.collection
<span class="bu">print</span> <span class="st">&#39;const_collection =&#39;</span>, results.const_collection</code></pre></div>
<hr />
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_action.py -h

<span class="kw">usage</span>: argparse_action.py [-h] [-s SIMPLE_VALUE] [-c] [-t] [-f]
                          [<span class="kw">-a</span> COLLECTION] [-A] [-B] [--version]

<span class="kw">optional</span> arguments:
  <span class="kw">-h</span>, --help       show this help message and exit
  <span class="kw">-s</span> SIMPLE_VALUE  Store a simple value
  <span class="kw">-c</span>               Store a constant value
  <span class="kw">-t</span>               Set a switch to true
  <span class="kw">-f</span>               Set a switch to false
  <span class="kw">-a</span> COLLECTION    Add repeated values to a list
  <span class="kw">-A</span>               Add different values to list
  <span class="kw">-B</span>               Add different values to list
  <span class="kw">--version</span>        show program<span class="st">&#39;s version number and exit</span>

<span class="st">$ python argparse_action.py -s value</span>

<span class="st">simple_value     = value</span>
<span class="st">constant_value   = None</span>
<span class="st">boolean_switch   = False</span>
<span class="st">collection       = []</span>
<span class="st">const_collection = []</span>

<span class="st">$ python argparse_action.py -c</span>

<span class="st">simple_value     = None</span>
<span class="st">constant_value   = value-to-store</span>
<span class="st">boolean_switch   = False</span>
<span class="st">collection       = []</span>
<span class="st">const_collection = []</span>

<span class="st">$ python argparse_action.py -t</span>

<span class="st">simple_value     = None</span>
<span class="st">constant_value   = None</span>
<span class="st">boolean_switch   = True</span>
<span class="st">collection       = []</span>
<span class="st">const_collection = []</span>

<span class="st">$ python argparse_action.py -f</span>

<span class="st">simple_value     = None</span>
<span class="st">constant_value   = None</span>
<span class="st">boolean_switch   = False</span>
<span class="st">collection       = []</span>
<span class="st">const_collection = []</span>

<span class="st">$ python argparse_action.py -a one -a two -a three</span>

<span class="st">simple_value     = None</span>
<span class="st">constant_value   = None</span>
<span class="st">boolean_switch   = False</span>
<span class="st">collection       = [&#39;</span>one<span class="st">&#39;, &#39;</span>two<span class="st">&#39;, &#39;</span>three<span class="st">&#39;]</span>
<span class="st">const_collection = []</span>

<span class="st">$ python argparse_action.py -B -A</span>

<span class="st">simple_value     = None</span>
<span class="st">constant_value   = None</span>
<span class="st">boolean_switch   = False</span>
<span class="st">collection       = []</span>
<span class="st">const_collection = [&#39;</span>value-2-to-append<span class="st">&#39;, &#39;</span>value-1-to-append<span class="st">&#39;]</span>

<span class="st">$ python argparse_action.py --version</span>

<span class="st">argparse_action.py 1.0</span></code></pre></div>
<h3 id="&#36873;&#39033;&#21069;&#32512;">5. &#36873;&#39033;&#21069;&#32512;</h3>
<p><code>argparse</code>&#36873;&#39033;&#30340;&#40664;&#35748;&#35821;&#27861;&#26159;&#22522;&#20110;Unix&#32422;&#23450;&#30340;&#65292;&#20351;&#29992;&#19968;&#20010;&#8220;-&#8221;&#21069;&#32512;&#26469;&#34920;&#31034;&#21629;&#20196;&#34892;&#24320;&#20851;&#12290;argparse&#25903;&#25345;&#20854;&#20182;&#21069;&#32512;&#65292;&#22240;&#27492;&#20320;&#21487;&#20197;&#20351;&#24471;&#20320;&#30340;&#31243;&#24207;&#36981;&#29031;&#26412;&#22320;&#24179;&#21488;&#30340;&#40664;&#35748;&#35821;&#27861;&#65288;&#20363;&#22914;&#65292;&#22312;Window&#19978;&#20351;&#29992;&#8220;/&#8221;&#65289;&#25110;&#32773;&#36981;&#24490;&#19981;&#21516;&#30340;&#32422;&#23450;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Change the option prefix charaters&#39;</span>, 
        prefix_chars<span class="op">=</span><span class="st">&#39;-+/&#39;</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_false&quot;</span>, default<span class="op">=</span><span class="va">None</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Turn A off&#39;</span>)

parser.add_argument(<span class="st">&#39;+a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">None</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Turn A on&#39;</span>)

parser.add_argument(<span class="st">&#39;//noarg&#39;</span>, <span class="st">&#39;++noarg&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#23558;<strong>ArgumentParser</strong>&#26041;&#27861;&#30340;<code>prefix_chars</code> &#21442;&#25968;&#35774;&#32622;&#20026;&#19968;&#20010;&#23383;&#31526;&#20018;&#65292;&#35813;&#23383;&#31526;&#20018;&#21253;&#21547;&#25152;&#26377;&#20801;&#35768;&#29992;&#26469;&#34920;&#31034;&#36873;&#39033;&#30340;&#23383;&#31526;&#12290;&#38656;&#35201;&#29702;&#35299;&#30340;&#26159;&#34429;&#28982;<code>prefix_chars</code>&#21253;&#21547;&#20801;&#35768;&#29992;&#20110;&#24320;&#20851;&#30340;&#23383;&#31526;&#65292;&#20294;&#21333;&#20010;&#21442;&#25968;&#23450;&#20041;&#21482;&#33021;&#20351;&#29992;&#19968;&#31181;&#32473;&#23450;&#30340;&#24320;&#20851;&#35821;&#27861;&#12290;&#36825;&#35753;&#20320;&#21487;&#20197;&#23545;&#20351;&#29992;&#19981;&#21516;&#21069;&#32512;&#30340;&#36873;&#39033;&#26159;&#21542;&#26159;&#21035;&#21517;&#65288;&#27604;&#22914;&#29420;&#31435;&#20110;&#24179;&#21488;&#30340;&#21629;&#20196;&#34892;&#35821;&#27861;&#30340;&#24773;&#20917;&#65289;&#25110;&#26367;&#20195;&#36873;&#25321;&#65288;&#20363;&#22914;&#65292;&#20351;&#29992;&#8220;+&#8221;&#34920;&#26126;&#25171;&#24320;&#19968;&#20010;&#24320;&#21457;&#65292;&#8220;-&#8221;&#21017;&#20026;&#20851;&#38381;&#19968;&#20010;&#24320;&#20851;&#65289;&#36827;&#34892;&#26174;&#24335;&#22320;&#25511;&#21046;&#12290;&#22312;&#19978;&#36848;&#20363;&#23376;&#20013;&#65292;<code>+a</code>&#21644;<code>-a</code>&#26159;&#19981;&#21516;&#30340;&#21442;&#25968;&#65292;<code>//noarg</code>&#20063;&#21487;&#20197; <code>++noarg</code>&#25552;&#20379;&#65292;&#20294;&#19981;&#26159;<code>--noarg</code>&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_prefix_chars.py -h

<span class="kw">usage</span>: argparse_prefix_chars.py [-h] [-a] [+a] [//noarg]

<span class="kw">Change</span> the option prefix characters

<span class="kw">optional</span> arguments
    <span class="kw">-h</span>, --help  show this help message and exit
    <span class="kw">-a</span>  Turn A off
    <span class="kw">+a</span>  Turn A on
    <span class="kw">/</span>/<span class="kw">noarg</span>,++noarg

$ <span class="kw">python</span> argparse_prefix_chars.py +a

<span class="kw">Namespace</span>(a=True, noarg=False)

$ <span class="kw">python</span> argparse_prefix_chars.py -a

<span class="kw">Namespace</span>(a=False, noarg=False)

$ <span class="kw">python</span> argparse_prefix_chars.py //noarg

<span class="kw">Namespace</span>(a=None, noarg=True)

$ <span class="kw">python</span> argparse_prefix_chars.py ++noarg

<span class="kw">Namespace</span>(a=None, noarg=True)

$ <span class="kw">python</span> argparse_prefix_chars.py --noarg

<span class="kw">usage</span>: argparse_prefix_chars.py [-h] [-a] [+a] [//noarg]
<span class="kw">argparse_prefix_chars.py</span>: error: unrecognized arguments: --noarg</code></pre></div>
<h3 id="&#21442;&#25968;&#26469;&#28304;">6. &#21442;&#25968;&#26469;&#28304;</h3>
<p>&#30446;&#21069;&#20026;&#27490;&#25152;&#35265;&#30340;&#20363;&#23376;&#20013;&#65292;&#25552;&#20379;&#32473;&#35299;&#26512;&#22120;&#30340;&#21442;&#25968;&#21015;&#34920;&#26469;&#33258;&#20110;&#26174;&#24335;&#20256;&#36882;&#30340;&#19968;&#20010;&#21015;&#34920;&#65292;&#25110;&#38544;&#24335;&#22320;&#20174;<code>sys.argv</code>&#33719;&#21462;&#30340;&#12290;&#26174;&#24335;&#20256;&#36882;&#21015;&#34920;&#22312;&#20320;&#20351;&#29992;<code>argparse</code>&#26469;&#22788;&#29702;&#31867;&#21629;&#20196;&#34892;&#20294;&#24182;&#19981;&#26159;&#26469;&#33258;&#21629;&#20196;&#34892;&#65288;&#27604;&#22914;&#26469;&#33258;&#19968;&#20010;&#37197;&#32622;&#25991;&#20214;&#65289;&#30340;&#25351;&#20196;&#20043;&#26102;&#27604;&#36739;&#26377;&#29992;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse
<span class="im">from</span> ConfigParser <span class="im">import</span> ConfigParser
<span class="im">import</span> shlex

parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Short sample app&#39;</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;b&quot;</span>)
parser.add_argument(<span class="st">&#39;-c&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;c&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)

config <span class="op">=</span> ConfigParser()
config.read(<span class="st">&#39;argparse_witH_shlex.ini&#39;</span>)
config_value <span class="op">=</span> config.get(<span class="st">&#39;cli&#39;</span>, <span class="st">&#39;options&#39;</span>)
<span class="bu">print</span> <span class="st">&#39;Config: &#39;</span>, config_value

argument_list <span class="op">=</span> shlex.split(config_value)
<span class="bu">print</span> <span class="st">&#39;Arg List:&#39;</span>, argument_list

<span class="bu">print</span> <span class="st">&#39;Results:&#39;</span>, parser.parse_args(argument_list)</code></pre></div>
<p><code>shlex</code>&#20351;&#24471;&#20999;&#20998;&#23384;&#20648;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#30340;&#23383;&#31526;&#20018;&#38750;&#24120;&#23481;&#26131;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_with_shlex.py

<span class="kw">Config</span>: -a -b 2
<span class="kw">Arg</span> List: [<span class="st">&#39;-a&#39;</span>, <span class="st">&#39;-b&#39;</span>, <span class="st">&#39;2&#39;</span>]
<span class="kw">Results</span>: Namespace(a=True, b=<span class="st">&#39;2&#39;</span>, c=None)</code></pre></div>
<p>&#21478;&#19968;&#31181;&#33258;&#24049;&#22788;&#29702;&#37197;&#32622;&#25991;&#20214;&#30340;&#26041;&#27861;&#26159;&#20351;&#29992;<code>fromfile_prefix_chars</code>&#25351;&#23450;&#19968;&#20010;&#21253;&#21547;&#19968;&#32452;&#35201;&#24453;&#22788;&#29702;&#21442;&#25968;&#30340;&#36755;&#20837;&#25991;&#20214;&#26469;&#21578;&#35785;<code>argparse</code>&#24590;&#26679;&#35782;&#21035;&#21442;&#25968;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse
<span class="im">from</span> ConfigParser <span class="im">import</span> ConfigParser
<span class="im">import</span> shlex

parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Short sample app&#39;</span>,
        fromfile_prefix_chars<span class="op">=</span><span class="st">&#39;@&#39;</span>
        )

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;b&quot;</span>)
parser.add_argument(<span class="st">&#39;-c&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;c&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)

<span class="bu">print</span> parser.parse_args([<span class="st">&#39;@argparse_fromfile_prefix_chars.txt&#39;</span>])</code></pre></div>
<p>&#35813;&#31034;&#20363;&#20195;&#30721;&#22312;&#25214;&#21040;&#19968;&#20010;&#20197;@&#20026;&#21069;&#32512;&#30340;&#21442;&#25968;&#26102;&#21363;&#20572;&#27490;&#24448;&#19979;&#35835;&#21462;&#65292;&#28982;&#21518;&#20174;&#20197;&#35813;&#21442;&#25968;&#21629;&#21517;&#30340;&#25991;&#20214;&#20013;&#26597;&#25214;&#26356;&#22810;&#30340;&#21442;&#25968;&#12290;&#20363;&#22914;&#65292;&#36755;&#20837;&#25991;&#20214;<code>argparse_fromfile_prefix_chars.txt</code>&#21253;&#21547;&#19968;&#31995;&#21015;&#21442;&#25968;&#65292;&#19968;&#34892;&#19968;&#20010;&#65306;</p>
<pre><code>-a
-b
2</code></pre>
<p>&#37027;&#20040;&#22788;&#29702;&#35813;&#25991;&#20214;&#20135;&#29983;&#30340;&#36755;&#20986;&#20026;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_fromfile_prefix_chars.py

<span class="kw">Namespace</span>(a=True, b=<span class="st">&#39;2&#39;</span>, c=None)</code></pre></div>
<h3 id="&#33258;&#21160;&#29983;&#25104;&#36873;&#39033;">7. &#33258;&#21160;&#29983;&#25104;&#36873;&#39033;</h3>
<p>&#32463;&#36807;&#37197;&#32622;<code>argparse</code>&#20250;&#33258;&#21160;&#28155;&#21152;&#36873;&#39033;&#29992;&#26469;&#29983;&#25104;&#24110;&#21161;&#20449;&#24687;&#20197;&#21450;&#20026;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#26174;&#31034;&#29256;&#26412;&#20449;&#24687;&#12290;</p>
<p><code>ArgumentParser</code>&#30340;&#21442;&#25968;<code>add_help</code>&#25511;&#21046;&#24110;&#21161;&#20449;&#24687;&#30456;&#20851;&#30340;&#36873;&#39033;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(add_help<span class="op">=</span><span class="va">True</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;b&quot;</span>)
parser.add_argument(<span class="st">&#39;-c&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;c&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#24110;&#21161;&#36873;&#39033;&#65288;<code>-h</code>&#21644;<code>--help</code>&#65289;&#40664;&#35748;&#26159;&#28155;&#21152;&#30340;&#65292;&#20294;&#21487;&#20197;&#36890;&#36807;&#23558;<code>add_help</code>&#35774;&#32622;&#20026;<code>false</code>&#26469;&#31105;&#29992;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(add_help<span class="op">=</span><span class="va">False</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;b&quot;</span>)
parser.add_argument(<span class="st">&#39;-c&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;c&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#34429;&#28982;<code>-h</code>&#21644;<code>--help</code>&#26159;&#20107;&#23454;&#19978;&#30340;&#35831;&#27714;&#24110;&#21161;&#30340;&#26631;&#20934;&#36873;&#39033;&#21517;&#31216;&#65292;&#20294;&#19968;&#20123;&#24212;&#29992;&#25110;<code>argparse</code>&#30340;&#20351;&#29992;&#35201;&#20040;&#19981;&#38656;&#35201;&#25552;&#20379;&#24110;&#21161;&#35201;&#20040;&#38656;&#35201;&#23558;&#36825;&#20004;&#20010;&#36873;&#39033;&#21517;&#31216;&#29992;&#20110;&#20854;&#20182;&#30446;&#26631;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_with_help.py -h

<span class="kw">usage</span>: argparse_with_help.py [-h] [-a] [-b B] [-c C]

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help  show this help message and exit
    <span class="kw">-a</span>
    <span class="kw">-b</span> B
    <span class="kw">-c</span> C

$ <span class="kw">python</span> argparse_without_help.py -h

<span class="kw">usage</span>: argparse_without_help.py [-a] [-b B] [-c C]
<span class="kw">argparse_without_help.py</span>: error: unrecognized arguments: -h</code></pre></div>
<p>&#24403;&#22312;<strong>ArgumentParser</strong>&#26500;&#36896;&#26041;&#27861;&#35774;&#32622;&#29256;&#26412;&#21518;&#65292;&#23601;&#20250;&#28155;&#21152;&#29256;&#26412;&#36873;&#39033;&#65288;<code>-v</code>&#21644;<code>--version</code>&#65289;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(version<span class="op">=</span><span class="st">&#39;1.0&#39;</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;b&quot;</span>)
parser.add_argument(<span class="st">&#39;-c&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, dest<span class="op">=</span><span class="st">&quot;c&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)

<span class="bu">print</span> parser.parse_args()

<span class="bu">print</span> <span class="st">&#39;This is not printed&#39;</span></code></pre></div>
<p>&#20004;&#31181;&#24418;&#24335;&#30340;&#36873;&#39033;&#29233;&#37027;&#20010;&#37117;&#20250;&#25171;&#21360;&#31243;&#24207;&#30340;&#29256;&#26412;&#23383;&#31526;&#20018;&#65292;&#28982;&#21518;&#31435;&#21363;&#36864;&#20986;&#31243;&#24207;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_with_version.py -h

<span class="kw">usage</span>: argparse_with_version.py [-h] [-v] [-a] [-b B] [-c C]

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help  show this help message and exit
    <span class="kw">-v</span>, --version   show program<span class="st">&#39;s version number and exit</span>
<span class="st">    -a</span>
<span class="st">    -b B</span>
<span class="st">    -c C</span>

<span class="st">$ python argparse_with_version.py -v</span>

<span class="st">1.0</span></code></pre></div>
<h3 id="&#35299;&#26512;&#22120;&#32452;">8. &#35299;&#26512;&#22120;&#32452;</h3>
<p><code>argparse</code>&#21253;&#21547;&#33509;&#24178;&#29305;&#24615;&#29992;&#20110;&#32452;&#32455;&#20320;&#30340;&#21442;&#25968;&#35299;&#26512;&#22120;&#65292;&#20351;&#24471;&#23454;&#29616;&#26356;&#20026;&#31616;&#21333;&#65292;&#20063;&#33021;&#25552;&#39640;&#36755;&#20986;&#24110;&#21161;&#20449;&#24687;&#30340;&#21487;&#29992;&#24615;&#12290;</p>
<h4 id="&#20849;&#20139;&#35299;&#26512;&#22120;&#35268;&#21017;">&#20849;&#20139;&#35299;&#26512;&#22120;&#35268;&#21017;</h4>
<p>&#25105;&#20204;&#24120;&#24120;&#38656;&#35201;&#23454;&#29616;&#19968;&#22871;&#21629;&#20196;&#34892;&#31243;&#24207;&#65292;&#36825;&#20123;&#31243;&#24207;&#37117;&#24102;&#19968;&#32452;&#21442;&#25968;&#65292;&#21482;&#26159;&#22312;&#26576;&#20123;&#26041;&#38754;&#26377;&#29305;&#27530;&#21270;&#12290;&#20363;&#22914;&#65292;&#22914;&#26524;&#25152;&#26377;&#31243;&#24207;&#37117;&#38656;&#35201;&#22312;&#29992;&#25143;&#36827;&#34892;&#20219;&#20309;&#23454;&#38469;&#30340;&#25805;&#20316;&#20043;&#21069;&#23545;&#29992;&#25143;&#36827;&#34892;&#35748;&#35777;&#65292;&#37027;&#20040;&#23427;&#20204;&#23601;&#37117;&#38656;&#35201;&#25903;&#25345;<code>--user</code>&#21644;<code>--password</code>&#36873;&#39033;&#12290;&#20320;&#21487;&#20197;&#20849;&#20139;&#30340;&#36873;&#39033;&#26469;&#23450;&#20041;&#19968;&#20010;&#8220;&#29238;&#27597;&#8221;&#35299;&#26512;&#22120;&#65292;&#28982;&#21518;&#20196;&#21333;&#20010;&#31243;&#24207;&#30340;&#35299;&#26512;&#22120;&#20174;&#35813;&#8220;&#29238;&#27597;&#8221;&#35299;&#26512;&#22120;&#32487;&#25215;&#20849;&#20139;&#36873;&#39033;&#65292;&#36825;&#26679;&#23601;&#19981;&#24517;&#26174;&#24335;&#20026;&#27599;&#20010;<strong>ArgumentParser</strong>&#28155;&#21152;&#20849;&#20139;&#36873;&#39033;&#12290;</p>
<p>&#31532;&#19968;&#27493;&#26159;&#20197;&#20849;&#20139;&#30340;&#21442;&#25968;&#23450;&#20041;&#24314;&#31435;&#8220;&#29238;&#27597;&#8221;&#35299;&#26512;&#22120;&#12290;&#30001;&#20110;&#8220;&#29238;&#27597;&#8221;&#35299;&#26512;&#22120;&#30340;&#21518;&#20195;&#20351;&#29992;&#32773;&#20250;&#28155;&#21152;&#30456;&#21516;&#30340;&#24110;&#21161;&#36873;&#39033;&#65292;&#20174;&#32780;&#20250;&#24341;&#21457;&#19968;&#20010;&#24322;&#24120;&#65292;&#25152;&#20197;&#22312;&#22522;&#30784;&#35299;&#26512;&#22120;&#20013;&#25105;&#20204;&#20851;&#38381;&#33258;&#21160;&#24110;&#21161;&#36873;&#39033;&#29983;&#25104;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(add_help<span class="op">=</span><span class="va">False</span>)

parser.add_argument(<span class="st">&#39;--user&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)
parser.add_argument(<span class="st">&#39;--password&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)</code></pre></div>
<p>&#25509;&#19979;&#26469;&#65292;&#20197;<strong>&#29238;&#27597;&#35299;&#26512;&#22120;&#38598;</strong>&#21019;&#24314;&#21478;&#19968;&#20010;&#35299;&#26512;&#22120;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse
<span class="im">import</span> argparse_parent_base

parser <span class="op">=</span> argparse.ArgumentParser(parents<span class="op">=</span>[argparse_parent_base.parser])

parser.add_argument(<span class="st">&#39;--local-arg&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#24471;&#21040;&#30340;&#31243;&#24207;&#24102;&#26377;&#19977;&#20010;&#36873;&#39033;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_uses_parent.py -h

<span class="kw">usage</span>: argparse_uses_parent.py [-h] [--user USER] [--password PASSWORD]
                           [<span class="kw">--local-arg</span>]

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help           show this help message and exit
    <span class="kw">--user</span> USER
    <span class="kw">--password</span> PASSWORD
    <span class="kw">--local-arg</span></code></pre></div>
<h4 id="&#20914;&#31361;&#30340;&#36873;&#39033;">&#20914;&#31361;&#30340;&#36873;&#39033;</h4>
<p>&#21069;&#19968;&#20010;&#20363;&#23376;&#25351;&#20986;&#20197;&#30456;&#21516;&#30340;&#21442;&#25968;&#21517;&#23383;&#20026;&#19968;&#20010;&#35299;&#26512;&#22120;&#28155;&#21152;&#20004;&#20010;&#21442;&#25968;&#22788;&#29702;&#22120;&#20250;&#24341;&#21457;&#19968;&#20010;&#24322;&#24120;&#12290;&#21487;&#20197;&#36890;&#36807;&#20256;&#36882;&#19968;&#20010;<code>conflict_handler</code>&#26469;&#25913;&#21464;&#20914;&#31361;&#28040;&#38500;&#34892;&#20026;&#12290;<code>argparse</code>&#26377;&#20004;&#20010;&#20869;&#32622;&#30340;&#20914;&#31361;&#22788;&#29702;&#22120;<code>error</code>&#65288;&#40664;&#35748;&#65289;&#21644;<code>resolve</code>&#65292;<code>resolve</code>&#20250;&#22522;&#20110;&#20914;&#31361;&#36873;&#39033;&#30340;&#28155;&#21152;&#39034;&#24207;&#26469;&#36873;&#25321;&#19968;&#20010;&#21442;&#25968;&#22788;&#29702;&#22120;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(conflict_handler<span class="op">=</span><span class="st">&#39;resolve&#39;</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Short alone&quot;</span>)
parser.add_argument(<span class="st">&#39;--long-b&#39;</span>, <span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Long and short together&quot;</span>)

<span class="bu">print</span> parser.parse_args([<span class="st">&#39;-h&#39;</span>])</code></pre></div>
<p>&#30001;&#20110;&#26368;&#21518;&#19968;&#20010;&#22788;&#29702;&#22120;&#25152;&#32473;&#23450;&#30340;&#21442;&#25968;&#21517;&#24050;&#34987;&#20351;&#29992;&#65292;&#37027;&#20040;&#26412;&#20363;&#20013;&#29420;&#31435;&#36873;&#39033;<code>-b</code>&#23558;&#34987;<code>--long-b</code>&#30340;&#21035;&#21517;&#25152;&#35206;&#30422;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">$ python argparse_conflict_handler_resolve.py

usage: argparse_conflict_handler_resolve.py [<span class="op">-</span>h] [<span class="op">-</span>a A] [<span class="op">--</span><span class="bu">long</span><span class="op">-</span>b LONG_B]

optional arguments:
    <span class="op">-</span>h, <span class="op">--</span><span class="bu">help</span>  show this <span class="bu">help</span> message <span class="op">and</span> exit
    <span class="op">-</span>a A
    <span class="op">--</span><span class="bu">long</span><span class="op">-</span>b LONG_B, <span class="op">-</span>b LONG_B
            Long <span class="op">and</span> short together</code></pre></div>
<p>&#20999;&#25442;<code>add_argument()</code>&#30340;&#35843;&#29992;&#39034;&#24207;&#23601;&#21487;&#20197;&#21551;&#29992;&#29420;&#31435;&#30340;&#36873;&#39033;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(conflict_handler<span class="op">=</span><span class="st">&#39;resolve&#39;</span>)

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)
parser.add_argument(<span class="st">&#39;--long-b&#39;</span>, <span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Long and short together&#39;</span>)
parser.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Short alone&#39;</span>)

<span class="bu">print</span> parser.parse_args([<span class="op">-</span>h])</code></pre></div>
<p>&#29616;&#22312;&#20004;&#20010;&#36873;&#39033;&#21487;&#20197;&#19968;&#36215;&#20351;&#29992;&#20102;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">$ python argparse_conflict_handler_resolve2.py

usage: argparse_conflict_handler_resolve2.py [<span class="op">-</span>h] [<span class="op">-</span>a A] [<span class="op">--</span><span class="bu">long</span><span class="op">-</span>b LONG_B] [<span class="op">-</span>b B]

optional arguments:
    <span class="op">-</span>h, <span class="op">--</span><span class="bu">help</span>  show this <span class="bu">help</span> message <span class="op">and</span> exit
    <span class="op">-</span>a A
    <span class="op">--</span><span class="bu">long</span><span class="op">-</span>b LONG_B Long <span class="op">and</span> short together
    <span class="op">-</span>b B    Short alone</code></pre></div>
<h4 id="&#21442;&#25968;&#32676;&#32452;">&#21442;&#25968;&#32676;&#32452;</h4>
<p><code>argparse</code>&#33021;&#23558;&#21442;&#25968;&#23450;&#20041;&#32452;&#21512;&#25104;&#8220;&#32676;&#32452;&#8221;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#26159;&#20351;&#29992;&#20004;&#20010;&#32676;&#32452;&#65292;&#19968;&#20010;&#26159;&#36873;&#39033;&#30340;&#32676;&#32452;&#65292;&#21478;&#19968;&#20010;&#26159;&#24517;&#39035;&#30340;&#19982;&#20301;&#32622;&#30456;&#20851;&#30340;&#21442;&#25968;&#32676;&#32452;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Short sample app&#39;</span>)

parser.add_argument(<span class="st">&#39;--optional&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)
parser.add_argument(<span class="st">&#39;positional&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#32676;&#32452;&#22312;&#36755;&#20986;&#30340;&#24110;&#21161;&#20449;&#24687;&#20013;&#26174;&#31034;&#20026;&#20998;&#24320;&#30340;&#8220;&#19982;&#20301;&#32622;&#30456;&#20851;&#30340;&#21442;&#25968;&#8221;&#21644;&#8220;&#21487;&#36873;&#21442;&#25968;&#8221;&#20004;&#20010;&#37096;&#20998;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_default_grouping.py

<span class="kw">usage</span>: argparse_default_grouping.py [-h] [--optional] positional

<span class="kw">Short</span> sample app

<span class="kw">positional</span> arguments:
    <span class="kw">positional</span>

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help  show this help message and exit
    <span class="kw">--optional</span></code></pre></div>
<p>&#20320;&#21487;&#20197;&#35843;&#25972;&#32676;&#32452;&#26469;&#25552;&#39640;&#24110;&#21161;&#20449;&#24687;&#20013;&#32676;&#32452;&#30340;&#36923;&#36753;&#24615;&#65292;&#36825;&#26679;&#30456;&#20851;&#36873;&#39033;&#25110;&#20540;&#33021;&#35760;&#24405;&#22312;&#19968;&#36215;&#12290;&#21487;&#20197;&#20351;&#29992;&#33258;&#23450;&#20041;&#32676;&#32452;&#26469;&#37325;&#20889;&#20043;&#21069;&#30340;&#20849;&#20139;&#36873;&#39033;&#30340;&#31034;&#20363;&#65292;&#22914;&#27492;&#22312;&#24110;&#21161;&#20449;&#24687;&#20013;&#36523;&#20221;&#35748;&#35777;&#30340;&#36873;&#39033;&#23601;&#21487;&#20197;&#26174;&#31034;&#22312;&#19968;&#36215;&#12290;</p>
<p>&#22312;&#22522;&#30784;&#35299;&#26512;&#22120;&#20013;&#20351;&#29992;<code>add_argument_group()</code>&#26469;&#21019;&#24314;&#19968;&#20010;&#8220;&#36523;&#20221;&#35748;&#35777;&#8221;&#32676;&#32452;&#65292;&#28982;&#21518;&#36880;&#20010;&#28155;&#21152;&#36523;&#20221;&#35748;&#35777;&#30456;&#20851;&#30340;&#36873;&#39033;&#21040;&#35813;&#32676;&#32452;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparser.ArgumentParser(add_help<span class="op">=</span><span class="va">False</span>)

group <span class="op">=</span> parser.add_argument_group(<span class="st">&#39;authentication&#39;</span>)

group.add_argument(<span class="st">&#39;--user&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)
group.add_argument(<span class="st">&#39;--password&#39;</span>, action<span class="op">=</span><span class="st">&quot;store&quot;</span>)</code></pre></div>
<p>&#19982;&#20043;&#21069;&#19968;&#26679;&#65292;&#31243;&#24207;&#20351;&#29992;&#22522;&#20110;&#32676;&#32452;&#30340;&#29238;&#27597;&#35299;&#26512;&#22120;&#21015;&#34920;&#20316;&#20026;<code>parents</code>&#30340;&#20540;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse
<span class="im">import</span> argparse_parent_with_group

parser <span class="op">=</span> argparse.ArgumentParser(parents<span class="op">=</span>[argparse_parent_with_group.parser])

parser.add_argument(<span class="st">&#39;--local-arg&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, default<span class="op">=</span><span class="va">False</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#29616;&#22312;&#36755;&#20986;&#30340;&#24110;&#21161;&#20449;&#24687;&#19968;&#36215;&#26174;&#31034;&#36523;&#20221;&#35748;&#35777;&#36873;&#39033;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_uses_parent_with_group.py -h

<span class="kw">usage</span>: argparse_uses_parent_with_group.py [-h] [--user USER] [--password PASSWORD] [--local-arg]

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help  show this message and exit
    <span class="kw">--local-arg</span>

<span class="kw">authentication</span>:
    <span class="kw">--user</span> USER
    <span class="kw">--password</span> PASSWORD</code></pre></div>
<h4 id="&#20114;&#26021;&#36873;&#39033;">&#20114;&#26021;&#36873;&#39033;</h4>
<p>&#23450;&#20041;&#20114;&#26021;&#30340;&#36873;&#39033;&#26159;&#36873;&#39033;&#20998;&#32452;&#29305;&#24615;&#30340;&#19968;&#20010;&#29305;&#20363;&#65292;&#20351;&#29992;<code>add_mutually_exclusive_group()</code>&#32780;&#19981;&#26159;<code>add_argument_group()</code>&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser()

group <span class="op">=</span> parser.add_mutually_exclusive_group()
group.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>)
group.add_argument(<span class="st">&#39;-b&#39;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p><code>argparse</code>&#20250;&#20026;&#20320;&#24378;&#21046;&#25191;&#34892;&#20114;&#26021;&#24615;&#65292;&#22240;&#27492;&#19968;&#27425;&#20351;&#29992;&#20165;&#33021;&#32473;&#20986;&#35813;&#32676;&#32452;&#30340;&#36873;&#39033;&#20013;&#30340;&#19968;&#20010;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_mutually_exclusive.py -h

<span class="kw">usage</span>: argparse_mutually_exclusive.py [-h] [-a <span class="kw">|</span> <span class="kw">-b</span>]

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help  show this help message and exit
    <span class="kw">-a</span>
    <span class="kw">-b</span>

$ <span class="kw">python</span> argparse_mutually_exclusive.py -a

<span class="kw">Namespace</span>(a=True, b=False)

$ <span class="kw">python</span> argparse_mutually_exclusive.py -b

<span class="kw">Namespace</span>(a=False, b=True)

$ <span class="kw">python</span> argparse_mutually_exclusive.py -a -b

<span class="kw">usage</span>: argparse_mutually_exclusive.py [-h] [-a <span class="kw">|</span> <span class="kw">-b</span>]
<span class="kw">argparse_mutually_exclusive.py</span>: error: argument -b: not allowed with argument -a</code></pre></div>
<h4 id="&#23884;&#22871;&#35299;&#26512;&#22120;">&#23884;&#22871;&#35299;&#26512;&#22120;</h4>
<p>&#19978;&#36848;&#30340;&#29238;&#27597;&#35299;&#26512;&#22120;&#26041;&#24335;&#26159;&#22312;&#30456;&#20851;&#21629;&#20196;&#20043;&#38388;&#20849;&#20139;&#36873;&#39033;&#30340;&#26041;&#24335;&#20043;&#19968;&#12290;&#21478;&#19968;&#31181;&#26041;&#24335;&#26159;&#23558;&#22810;&#20010;&#21629;&#20196;&#32452;&#21512;&#36827;&#19968;&#20010;&#31243;&#24207;&#20013;&#65292;&#20351;&#29992;&#23376;&#35299;&#26512;&#22120;&#26469;&#22788;&#29702;&#21629;&#20196;&#34892;&#30340;&#27599;&#20010;&#37096;&#20998;&#12290;&#23601;&#20687;svn&#65292;hg&#65292;&#20197;&#21450;&#20854;&#20182;&#24102;&#26377;&#22810;&#20010;&#21629;&#20196;&#34892;&#34892;&#20026;&#25110;&#23376;&#21629;&#20196;&#30340;&#31243;&#24207;&#37027;&#26679;&#12290;</p>
<p>&#19968;&#20010;&#29992;&#20110;&#22788;&#29702;&#25991;&#20214;&#31995;&#32479;&#30446;&#24405;&#30340;&#31243;&#24207;&#21487;&#33021;&#20250;&#20687;&#36825;&#26679;&#23450;&#20041;&#21629;&#20196;&#29992;&#20110;&#21019;&#24314;&#12289;&#21024;&#38500;&#12289;&#20197;&#21450;&#21015;&#20986;&#19968;&#20010;&#30446;&#24405;&#30340;&#20869;&#23481;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser()

subparsers <span class="op">=</span> parser.add_subparsers(<span class="bu">help</span><span class="op">=</span><span class="st">&#39;commands&#39;</span>)

<span class="co"># A list command</span>
list_parser <span class="op">=</span> subparsers.add_parser(<span class="st">&#39;list&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;List contents&#39;</span>)
list_parser.add_argument(<span class="st">&#39;dirname&#39;</span>, action<span class="op">=</span><span class="st">&#39;store&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Directory to list&#39;</span>)

<span class="co"># A create command</span>
create_parser <span class="op">=</span> subparsers.add_parser(<span class="st">&#39;create&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Create a directory&#39;</span>)
create_parser.add_argument(<span class="st">&#39;dirname&#39;</span>, action<span class="op">=</span><span class="st">&#39;store&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;New directory to create&#39;</span>)
create_parser.add_argument(<span class="st">&#39;--read-only&#39;</span>, default<span class="op">=</span><span class="va">False</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Set permissions to prevent writing to the directory&#39;</span>)

<span class="co"># A delete command</span>
delete_parser <span class="op">=</span> subparsers.add_parser(<span class="st">&#39;delete&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Remove a directory&#39;</span>)
delete_parser.add_argument(<span class="st">&#39;dirname&#39;</span>, action<span class="op">=</span><span class="st">&#39;store&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;The directory to remove&#39;</span>)
delete_parser.add_argument(<span class="st">&#39;--recursive&#39;</span>, <span class="st">&#39;-r&#39;</span>, default<span class="op">=</span><span class="va">False</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>,
        <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Remove the contents of the directory, too&#39;</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#36755;&#20986;&#30340;&#24110;&#21161;&#20449;&#24687;&#26174;&#31034;&#20316;&#20026;&#8220;&#21629;&#20196;&#8221;&#30340;&#21629;&#21517;&#23376;&#35299;&#26512;&#22120;&#33021;&#22815;&#22312;&#21629;&#20196;&#34892;&#20013;&#20316;&#20026;&#20301;&#32622;&#21442;&#25968;&#36827;&#34892;&#25351;&#23450;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_subparsers.py -h

<span class="kw">usage</span>: argparse_subparsers.py [-h] {list, create, delete} <span class="kw">...</span>

<span class="kw">positional</span> arguments:
    {<span class="kw">list</span>, create, delete} <span class="kw">commands</span>
        <span class="kw">list</span>    List contents
        <span class="kw">create</span>  Create a directory
        <span class="kw">delete</span>  Remove a directory

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help  show this help message and exit</code></pre></div>
<p>&#27599;&#20010;&#23376;&#35299;&#26512;&#22120;&#20063;&#26377;&#33258;&#24049;&#30340;&#24110;&#21161;&#20449;&#24687;&#65292;&#25551;&#36848;&#37027;&#20010;&#21629;&#20196;&#30340;&#21442;&#25968;&#21644;&#36873;&#39033;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_subparsers.py create -h

<span class="kw">usage</span>: argparse_subparsers.py create [-h] [--read-only] dirname

<span class="kw">positional</span> arguments:
    <span class="kw">dirname</span> New directory to create

<span class="kw">optional</span> arguments:
    <span class="kw">-h</span>, --help  show this help message and exit
    <span class="kw">--read-only</span> Set permissions to prevent writing to the directory</code></pre></div>
<p>&#21442;&#25968;&#34987;&#35299;&#26512;&#21518;&#65292;<code>parse_args()</code>&#36820;&#22238;&#30340;<code>Namespace</code>&#23545;&#35937;&#20165;&#21253;&#21547;&#19982;&#25351;&#23450;&#30340;&#21629;&#20196;&#30456;&#20851;&#30340;&#20540;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_subparsers.py delete -r foo

<span class="kw">Namespace</span>(dirname=<span class="st">&#39;foo&#39;</span>, recursive=True)</code></pre></div>
<h3 id="&#39640;&#32423;&#21442;&#25968;&#22788;&#29702;">8. &#39640;&#32423;&#21442;&#25968;&#22788;&#29702;</h3>
<p>&#33267;&#20170;&#20026;&#27490;&#30340;&#31034;&#20363;&#23637;&#31034;&#20102;&#31616;&#21333;&#30340;&#24067;&#23572;&#26631;&#35782;&#12289;&#23383;&#31526;&#20018;&#25110;&#25968;&#23383;&#21442;&#25968;&#36873;&#39033;&#12289;&#20197;&#21450;&#20301;&#32622;&#21442;&#25968;&#12290;&#23545;&#20110;&#21464;&#38271;&#21442;&#25968;&#21015;&#34920;&#12289;&#26522;&#20030;&#31867;&#22411;&#25968;&#25454;&#12289;&#20197;&#21450;&#24120;&#37327;&#65292;argparse&#25903;&#25345;&#22797;&#26434;&#30340;&#21442;&#25968;&#35268;&#26684;&#12290;</p>
<h4 id="&#21487;&#21464;&#24418;&#21442;&#21015;&#34920;">&#21487;&#21464;&#24418;&#21442;&#21015;&#34920;</h4>
<p>&#20320;&#21487;&#20197;&#37197;&#32622;&#21333;&#20010;&#21442;&#25968;&#30340;&#23450;&#20041;&#20351;&#20854;&#33021;&#22815;&#21305;&#37197;&#25152;&#35299;&#26512;&#30340;&#21629;&#20196;&#34892;&#30340;&#22810;&#20010;&#21442;&#25968;&#12290;&#26681;&#25454;&#38656;&#35201;&#25110;&#26399;&#26395;&#30340;&#21442;&#25968;&#20010;&#25968;&#65292;&#35774;&#32622;<code>nargs</code>&#20026;&#36825;&#20123;&#26631;&#35782;&#20540;&#20043;&#19968;&#65306;</p>
<pre><code>&#20540;  &#21547;&#20041;
N   &#21442;&#25968;&#30340;&#32477;&#23545;&#20010;&#25968;&#65288;&#20363;&#22914;&#65306;3&#65289;
?   0&#25110;1&#20010;&#21442;&#25968;
*   0&#25110;&#25152;&#26377;&#21442;&#25968;
+   &#25152;&#26377;&#65292;&#24182;&#19988;&#33267;&#23569;&#19968;&#20010;&#21442;&#25968;</code></pre>
<hr />
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser()

parser.add_argument(<span class="st">&#39;--three&#39;</span>, nargs<span class="op">=</span><span class="dv">3</span>)
parser.add_argument(<span class="st">&#39;--optional&#39;</span>, nargs<span class="op">=</span><span class="st">&#39;?&#39;</span>)
parser.add_argument(<span class="st">&#39;--all&#39;</span>, nargs<span class="op">=</span><span class="st">&#39;*&#39;</span>, dest<span class="op">=</span><span class="st">&#39;all&#39;</span>)
parser.add_argument(<span class="st">&#39;--one-or-more&#39;</span>, nargs<span class="op">=</span><span class="st">&#39;+&#39;</span>)

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#35299;&#26512;&#22120;&#24378;&#21046;&#25191;&#34892;&#21442;&#25968;&#35745;&#25968;&#25351;&#20196;&#65292;&#29983;&#25104;&#19968;&#20010;&#31934;&#30830;&#30340;&#35821;&#27861;&#22270;&#20316;&#20026;&#21629;&#20196;&#24110;&#21161;&#25991;&#26412;&#30340;&#19968;&#37096;&#20998;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_nargs.py -h

<span class="kw">usage</span>: argparse_nargs.py [-h] [--three THREE THREE THREE]
                     [<span class="kw">--optional</span> [OPTIONAL]] [--all [ALL [ALL ...]]]
                     [<span class="kw">--one-or-more</span> ONE_OR_MORE [ONE_OR_MORE ...]]

<span class="kw">optional</span> arguments:
<span class="kw">-h</span>, --help            show this help message and exit
<span class="kw">--three</span> THREE THREE THREE
<span class="kw">--optional</span> [OPTIONAL]
<span class="kw">--all</span> [ALL [ALL ...]]
<span class="kw">--one-or-more</span> ONE_OR_MORE [ONE_OR_MORE ...]

$ <span class="kw">python</span> argparse_nargs.py

<span class="kw">Namespace</span>(all=None, one_or_more=None, optional=None, three=None)

$ <span class="kw">python</span> argparse_nargs.py --three

<span class="kw">usage</span>: argparse_nargs.py [-h] [--three THREE THREE THREE]
                     [<span class="kw">--optional</span> [OPTIONAL]] [--all [ALL [ALL ...]]]
                     [<span class="kw">--one-or-more</span> ONE_OR_MORE [ONE_OR_MORE ...]]
<span class="kw">argparse_nargs.py</span>: error: argument --three: expected 3 argument(s)

$ <span class="kw">python</span> argparse_nargs.py --three a b c

<span class="kw">Namespace</span>(all=None, one_or_more=None, optional=None, three=[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>])

$ <span class="kw">python</span> argparse_nargs.py --optional

<span class="kw">Namespace</span>(all=None, one_or_more=None, optional=None, three=None)

$ <span class="kw">python</span> argparse_nargs.py --optional with_value

<span class="kw">Namespace</span>(all=None, one_or_more=None, optional=<span class="st">&#39;with_value&#39;</span>, three=None)

$ <span class="kw">python</span> argparse_nargs.py --all with multiple values

<span class="kw">Namespace</span>(all=[<span class="st">&#39;with&#39;</span>, <span class="st">&#39;multiple&#39;</span>, <span class="st">&#39;values&#39;</span>], one_or_more=None, optional=None, three=None)

$ <span class="kw">python</span> argparse_nargs.py --one-or-more with_value

<span class="kw">Namespace</span>(all=None, one_or_more=[<span class="st">&#39;with_value&#39;</span>], optional=None, three=None)

$ <span class="kw">python</span> argparse_nargs.py --one-or-more with multiple values

<span class="kw">Namespace</span>(all=None, one_or_more=[<span class="st">&#39;with&#39;</span>, <span class="st">&#39;multiple&#39;</span>, <span class="st">&#39;values&#39;</span>], optional=None, three=None)

$ <span class="kw">python</span> argparse_nargs.py --one-or-more

<span class="kw">usage</span>: argparse_nargs.py [-h] [--three THREE THREE THREE]
                     [<span class="kw">--optional</span> [OPTIONAL]] [--all [ALL [ALL ...]]]
                     [<span class="kw">--one-or-more</span> ONE_OR_MORE [ONE_OR_MORE ...]]
<span class="kw">argparse_nargs.py</span>: error: argument --one-or-more: expected at least one argument</code></pre></div>
<h4 id="&#21442;&#25968;&#31867;&#22411;">&#21442;&#25968;&#31867;&#22411;</h4>
<p><code>argparse</code>&#23558;&#25152;&#26377;&#21442;&#25968;&#20540;&#37117;&#30475;&#20316;&#26159;&#23383;&#31526;&#20018;&#65292;&#38500;&#38750;&#20320;&#21578;&#35785;&#23427;&#23558;&#23383;&#31526;&#20018;&#36716;&#25442;&#25104;&#21478;&#19968;&#31181;&#25968;&#25454;&#31867;&#22411;&#12290;<code>add_argument()</code>&#30340;<code>type</code>&#21442;&#25968;&#20197;&#19968;&#20010;&#36716;&#25442;&#20989;&#25968;&#20316;&#20026;&#20540;&#65292;&#34987;<code>ArgumentParser</code>&#29992;&#26469;&#23558;&#21442;&#25968;&#20540;&#20174;&#19968;&#20010;&#23383;&#31526;&#20018;&#36716;&#25442;&#25104;&#21478;&#19968;&#31181;&#25968;&#25454;&#31867;&#22411;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser()

parser.add_argument(<span class="st">&#39;-i&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)
parser.add_argument(<span class="st">&#39;-f&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">float</span>)
parser.add_argument(<span class="st">&#39;--file&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">file</span>)

<span class="cf">try</span>:
    <span class="bu">print</span> parser.parse_args()
<span class="cf">except</span> <span class="pp">IOError</span>, msg:
    parser.error(<span class="bu">str</span>(msg))</code></pre></div>
<p>&#20219;&#20309;&#38656;&#35201;&#21333;&#20010;&#23383;&#31526;&#20018;&#21442;&#25968;&#30340;&#21487;&#35843;&#29992;&#23545;&#35937;&#37117;&#21487;&#20197;&#20256;&#36882;&#32473;<code>type</code>&#65292;&#21253;&#21547;&#20869;&#32622;&#31867;&#22411;&#22914;<code>int()</code>, <code>float()</code>, &#20197;&#21450;<code>file()</code>&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">$ python argparse_type.py <span class="op">-</span>i <span class="dv">1</span>

Namespace(f<span class="op">=</span><span class="va">None</span>, <span class="bu">file</span><span class="op">=</span><span class="va">None</span>, i<span class="op">=</span><span class="dv">1</span>)

$ python argparse_type.py <span class="op">-</span>f <span class="fl">3.14</span>

Namespace(f<span class="op">=</span><span class="fl">3.14</span>, <span class="bu">file</span><span class="op">=</span><span class="va">None</span>, i<span class="op">=</span><span class="va">None</span>)

$ python argparse_type.py <span class="op">--</span><span class="bu">file</span> argparse_type.py

Namespace(f<span class="op">=</span><span class="va">None</span>, <span class="bu">file</span><span class="op">=&lt;</span><span class="bu">open</span> <span class="bu">file</span> <span class="st">&#39;argparse_type.py&#39;</span>, mode <span class="st">&#39;r&#39;</span> at <span class="bn">0x1004de270</span><span class="op">&gt;</span>, i<span class="op">=</span><span class="va">None</span>)</code></pre></div>
<p>&#22914;&#26524;&#31867;&#22411;&#36716;&#25442;&#22833;&#36133;&#65292;argparse&#20250;&#24341;&#21457;&#19968;&#20010;&#24322;&#24120;&#12290;<code>TypeError</code>&#21644;<code>ValueError</code>&#20250;&#34987;&#33258;&#21160;&#25429;&#33719;&#65292;&#24182;&#20026;&#29992;&#25143;&#36716;&#25442;&#20026;&#19968;&#20010;&#31616;&#21333;&#30340;&#38169;&#35823;&#28040;&#24687;&#12290;&#20854;&#20182;&#24322;&#24120;&#65292;&#22914;&#19979;&#38754;&#19968;&#20010;&#20363;&#23376;&#20013;&#36755;&#20837;&#25991;&#20214;&#19981;&#23384;&#22312;&#65292;&#21017;&#20854;IOError&#24517;&#39035;&#30001;&#35843;&#29992;&#32773;&#26469;&#22788;&#29702;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_type.py -i a

<span class="kw">usage</span>: argparse_type.py [-h] [-i I] [-f F] [--file FILE]
<span class="kw">argparse_type.py</span>: error: argument -i: invalid int value: <span class="st">&#39;a&#39;</span>

$ <span class="kw">python</span> argparse_type.py -f 3.14.15

<span class="kw">usage</span>: argparse_type.py [-h] [-i I] [-f F] [--file FILE]
<span class="kw">argparse_type.py</span>: error: argument -f: invalid float value: <span class="st">&#39;3.14.15&#39;</span>

$ <span class="kw">python</span> argparse_type.py --file does_not_exist.txt

<span class="kw">usage</span>: argparse_type.py [-h] [-i I] [-f F] [--file FILE]
<span class="kw">argparse_type.py</span>: error: [Errno 2] No such file or directory: <span class="st">&#39;does_not_exist.txt&#39;</span></code></pre></div>
<p>&#35201;&#24819;&#23558;&#19968;&#20010;&#36755;&#20837;&#21442;&#25968;&#38480;&#21046;&#20026;&#19968;&#20010;&#39044;&#23450;&#20041;&#38598;&#20013;&#30340;&#26576;&#20010;&#20540;&#65292;&#21017;&#20351;&#29992;<code>choices</code>&#21442;&#25968;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser()

parser.add_argument(<span class="st">&#39;--mode&#39;</span>, choices<span class="op">=</span>(<span class="st">&#39;read-only&#39;</span>, <span class="st">&#39;read-write&#39;</span>))

<span class="bu">print</span> parser.parse_args()</code></pre></div>
<p>&#22914;&#26524;<code>--mode</code>&#30340;&#21442;&#25968;&#20540;&#19981;&#26159;&#25152;&#20801;&#35768;&#30340;&#20540;&#20013;&#30340;&#19968;&#20010;&#65292;&#23601;&#20250;&#20135;&#29983;&#19968;&#20010;&#38169;&#35823;&#24182;&#20572;&#27490;&#25191;&#34892;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_choices.py -h

<span class="kw">usage</span>: argparse_choices.py [-h] [--mode <span class="dt">{read-only,read-write}</span>]

<span class="kw">optional</span> arguments:
<span class="kw">-h</span>, --help            show this help message and exit
<span class="kw">--mode</span> <span class="dt">{read-only,read-write}</span>

$ <span class="kw">python</span> argparse_choices.py --mode read-only

<span class="kw">Namespace</span>(mode=<span class="st">&#39;read-only&#39;</span>)

$ <span class="kw">python</span> argparse_choices.py --mode invalid

<span class="kw">usage</span>: argparse_choices.py [-h] [--mode <span class="dt">{read-only,read-write}</span>]
<span class="kw">argparse_choices.py</span>: error: argument --mode: invalid choice: <span class="st">&#39;invalid&#39;</span>
<span class="kw">(choose</span> from <span class="st">&#39;read-only&#39;</span>, <span class="st">&#39;read-write&#39;</span><span class="kw">)</span></code></pre></div>
<h4 id="&#25991;&#20214;&#21442;&#25968;">&#25991;&#20214;&#21442;&#25968;</h4>
<p>&#34429;&#28982;&#25991;&#20214;&#23545;&#35937;&#21487;&#20197;&#21333;&#20010;&#23383;&#31526;&#20018;&#21442;&#25968;&#20540;&#26469;&#23454;&#20363;&#21270;&#65292;&#20294;&#24182;&#19981;&#20801;&#35768;&#20320;&#25351;&#23450;&#35775;&#38382;&#27169;&#24335;&#12290;<code>FileType</code>&#35753;&#20320;&#33021;&#22815;&#26356;&#21152;&#28789;&#27963;&#22320;&#25351;&#23450;&#26576;&#20010;&#21442;&#25968;&#24212;&#35813;&#26159;&#20010;&#25991;&#20214;&#65292;&#21253;&#25324;&#20854;&#35775;&#38382;&#27169;&#24335;&#21644;&#32531;&#20914;&#21306;&#22823;&#23567;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

parser <span class="op">=</span> argparse.ArgumentParser()

parser.add_argument(<span class="st">&#39;-i&#39;</span>, metavar<span class="op">=</span><span class="st">&#39;in-file&#39;</span>, <span class="bu">type</span><span class="op">=</span>argparse.FileType(<span class="st">&#39;rt&#39;</span>))
parser.add_argument(<span class="st">&#39;-o&#39;</span>, metavar<span class="op">=</span><span class="st">&#39;out-file&#39;</span>, <span class="bu">type</span><span class="op">=</span>argparse.FileType(<span class="st">&#39;wt&#39;</span>))

<span class="cf">try</span>:
    results <span class="op">=</span> parser.parse_args()
    <span class="bu">print</span> <span class="st">&#39;Input file:&#39;</span>, results.i
    <span class="bu">print</span> <span class="st">&#39;Output file:&#39;</span>, results.o
<span class="cf">except</span> <span class="pp">IOError</span>, msg:
    parser.error(<span class="bu">str</span>(msg))</code></pre></div>
<p>&#19978;&#20363;&#20013;&#19982;&#21442;&#25968;&#21517;&#20851;&#32852;&#30340;&#20540;&#26159;&#19968;&#20010;&#25171;&#24320;&#25991;&#20214;&#21477;&#26564;&#12290;&#22312;&#20351;&#29992;&#23436;&#35813;&#25991;&#20214;&#21518;&#24212;&#33258;&#24049;&#36127;&#36131;&#20851;&#38381;&#35813;&#25991;&#20214;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_FileType.py -h

<span class="kw">usage</span>: argparse_FileType.py [-h] [-i in-file] [-o out-file]

<span class="kw">optional</span> arguments:
<span class="kw">-h</span>, --help   show this help message and exit
<span class="kw">-i</span> in-file
<span class="kw">-o</span> out-file

$ <span class="kw">python</span> argparse_FileType.py -i argparse_FileType.py -o temporary_file.\
txt

<span class="kw">Input</span> file: <span class="kw">&lt;</span>open file <span class="st">&#39;argparse_FileType.py&#39;</span>, mode <span class="st">&#39;rt&#39;</span> at 0x1004de<span class="kw">270&gt;</span>
<span class="kw">Output</span> file: <span class="kw">&lt;</span>open file <span class="st">&#39;temporary_file.txt&#39;</span>, mode <span class="st">&#39;wt&#39;</span> at 0x1004de<span class="kw">300&gt;</span>

$ <span class="kw">python</span> argparse_FileType.py -i no_such_file.txt

<span class="kw">usage</span>: argparse_FileType.py [-h] [-i in-file] [-o out-file]
<span class="kw">argparse_FileType.py</span>: error: argument -i: can<span class="st">&#39;t open &#39;</span>no_such_file.txt<span class="st">&#39;: [Errno 2] No such file or directory: &#39;</span>no_such_file.txt<span class="st">&#39;</span></code></pre></div>
<h4 id="&#33258;&#23450;&#20041;&#21160;&#20316;">&#33258;&#23450;&#20041;&#21160;&#20316;</h4>
<p>&#38500;&#20102;&#21069;&#38754;&#25551;&#36848;&#30340;&#20869;&#32622;&#21160;&#20316;&#20043;&#22806;&#65292;&#20320;&#20063;&#21487;&#20197;&#25552;&#20379;&#19968;&#20010;&#23454;&#29616;&#20102;<code>Action API</code>&#30340;&#23545;&#35937;&#26469;&#33258;&#23450;&#20041;&#21160;&#20316;&#12290;&#20316;&#20026;<code>action</code>&#20256;&#36882;&#32473;<code>add_argument()</code>&#30340;&#23545;&#35937;&#24212;&#25509;&#21463;&#25551;&#36848;&#25152;&#23450;&#20041;&#24418;&#21442;&#30340;&#23454;&#21442;&#65292;&#24182;&#36820;&#22238;&#19968;&#20010;&#21487;&#35843;&#29992;&#23545;&#35937;&#65292;&#20316;&#20026;<code>parser</code>&#30340;&#23454;&#21442;&#26469;&#22788;&#29702;&#24418;&#21442;&#65292;<code>namespace</code>&#23384;&#25918;&#35299;&#26512;&#30340;&#32467;&#26524;&#12289;&#21442;&#25968;&#20540;&#65292;&#20197;&#21450;&#35302;&#21457;&#21160;&#20316;&#30340;<code>option_string</code>&#12290;</p>
<p>argparse&#25552;&#20379;&#20102;&#19968;&#20010;Action&#31867;&#20316;&#20026;&#35201;&#23450;&#20041;&#30340;&#26032;&#21160;&#20316;&#30340;&#22522;&#31867;&#12290;&#26500;&#36896;&#26041;&#27861;&#26159;&#22788;&#29702;&#21442;&#25968;&#23450;&#20041;&#30340;&#65292;&#25152;&#20197;&#20320;&#21482;&#35201;&#22312;&#23376;&#31867;&#20013;&#35206;&#30422;<code>call()</code>&#12290;</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> argparse

<span class="kw">class</span> CustomAction(argparse.Action):
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,
            option_strings,
            dest,
            nargs<span class="op">=</span><span class="va">None</span>,
            const<span class="op">=</span><span class="va">None</span>,
            default<span class="op">=</span><span class="va">None</span>,
            <span class="bu">type</span><span class="op">=</span><span class="va">None</span>,
            choices<span class="op">=</span><span class="va">None</span>,
            required<span class="op">=</span><span class="va">False</span>,
            <span class="bu">help</span><span class="op">=</span><span class="va">None</span>,
            metavar<span class="op">=</span><span class="va">None</span>):
        argparse.Action.<span class="fu">__init__</span>(<span class="va">self</span>,
                option_strings<span class="op">=</span>option_strings,
                dest<span class="op">=</span>dest,
                nargs<span class="op">=</span>nargs,
                const<span class="op">=</span>const,
                default<span class="op">=</span>default,
                <span class="bu">type</span><span class="op">=</span><span class="bu">type</span>,
                choices<span class="op">=</span>choices,
                required<span class="op">=</span>required,
                <span class="bu">help</span><span class="op">=</span><span class="bu">help</span>,
                metavar<span class="op">=</span>metavar)
        <span class="bu">print</span>
        <span class="bu">print</span> <span class="st">&#39;Initializing CustomAction&#39;</span>
        <span class="cf">for</span> name,value <span class="op">in</span> <span class="bu">sorted</span>(<span class="bu">locals</span>().items()):
            <span class="cf">if</span> name <span class="op">==</span> <span class="st">&#39;self&#39;</span> <span class="op">or</span> value <span class="op">is</span> <span class="va">None</span>:
                <span class="cf">continue</span>
            <span class="bu">print</span> <span class="st">&#39;  </span><span class="sc">%s</span><span class="st"> = </span><span class="sc">%r</span><span class="st">&#39;</span> <span class="op">%</span> (name, value)
        <span class="cf">return</span>

    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, parser, namespace, values, option_string<span class="op">=</span><span class="va">None</span>):
        <span class="bu">print</span>
        <span class="bu">print</span> <span class="st">&#39;Processing CustomAction for &quot;</span><span class="sc">%s</span><span class="st">&quot;&#39;</span> <span class="op">%</span> <span class="va">self</span>.dest
        <span class="bu">print</span> <span class="st">&#39;  parser = </span><span class="sc">%s</span><span class="st">&#39;</span> <span class="op">%</span> <span class="bu">id</span>(parser)
        <span class="bu">print</span> <span class="st">&#39;  values = </span><span class="sc">%r</span><span class="st">&#39;</span> <span class="op">%</span> values
        <span class="bu">print</span> <span class="st">&#39;  option_string = </span><span class="sc">%r</span><span class="st">&#39;</span> <span class="op">%</span> option_string

        <span class="co"># Do some arbitrary processing of the input values</span>
        <span class="cf">if</span> <span class="bu">isinstance</span>(values, <span class="bu">list</span>):
            values <span class="op">=</span> [ v.upper() <span class="cf">for</span> v <span class="op">in</span> values ]
        <span class="cf">else</span>:
            values <span class="op">=</span> values.upper()
        <span class="co"># Save the results in the namespace using the destination</span>
        <span class="co"># variable given to our constructor.</span>
        <span class="bu">setattr</span>(namespace, <span class="va">self</span>.dest, values)

parser <span class="op">=</span> argparse.ArgumentParser()

parser.add_argument(<span class="st">&#39;-a&#39;</span>, action<span class="op">=</span>CustomAction)
parser.add_argument(<span class="st">&#39;-m&#39;</span>, nargs<span class="op">=</span><span class="st">&#39;*&#39;</span>, action<span class="op">=</span>CustomAction)
parser.add_argument(<span class="st">&#39;positional&#39;</span>, action<span class="op">=</span>CustomAction)

results <span class="op">=</span> parser.parse_args([<span class="st">&#39;-a&#39;</span>, <span class="st">&#39;value&#39;</span>, <span class="st">&#39;-m&#39;</span> <span class="st">&#39;multi-value&#39;</span>, <span class="st">&#39;positional-value&#39;</span>])
<span class="bu">print</span>
<span class="bu">print</span> results</code></pre></div>
<p><code>values</code>&#30340;&#31867;&#22411;&#21462;&#20915;&#20110;<code>nargs</code>&#30340;&#20540;&#12290;&#22914;&#26524;&#35813;&#21442;&#25968;&#20801;&#35768;&#22810;&#20010;&#20540;&#65292;&#21017;<code>values</code>&#20250;&#26159;&#19968;&#20010;&#21015;&#34920;&#65292;&#21363;&#20351;&#20854;&#20165;&#21253;&#21547;&#19968;&#20010;&#21015;&#34920;&#39033;&#12290;</p>
<p><code>option_string</code>&#30340;&#20540;&#20063;&#21462;&#20915;&#20110;&#21407;&#26377;&#30340;&#21442;&#25968;&#35268;&#33539;&#12290;&#23545;&#20110;&#20301;&#32622;&#30456;&#20851;&#30340;&#12289;&#24517;&#38656;&#30340;&#21442;&#25968;&#65292;<code>option_string</code>&#22987;&#32456;&#20026;<code>None</code>&#12290;</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> argparse_custom_action.py

<span class="kw">Initializing</span> CustomAction
    <span class="kw">dest</span> = <span class="st">&#39;a&#39;</span>
    <span class="kw">option_strings</span> = [<span class="st">&#39;-a&#39;</span>]
    <span class="kw">required</span> = False

<span class="kw">Initializing</span> CustomAction
    <span class="kw">dest</span> = <span class="st">&#39;m&#39;</span>
    <span class="kw">nargs</span> = <span class="st">&#39;*&#39;</span>
    <span class="kw">option_strings</span> = [<span class="st">&#39;-m&#39;</span>]
    <span class="kw">required</span> = False

<span class="kw">Initializing</span> CustomAction
    <span class="kw">dest</span> = <span class="st">&#39;positional&#39;</span>
    <span class="kw">option_strings</span> = []
    <span class="kw">required</span> = True

<span class="kw">Processing</span> CustomAction for <span class="st">&quot;a&quot;</span>
    <span class="kw">parser</span> = 4299616464
    <span class="kw">values</span> = <span class="st">&#39;value&#39;</span>
    <span class="kw">option_string</span> = <span class="st">&#39;-a&#39;</span>

<span class="kw">Processing</span> CustomAction for <span class="st">&quot;m&quot;</span>
    <span class="kw">parser</span> = 4299616464
    <span class="kw">values</span> = [<span class="st">&#39;multi-value&#39;</span>]
    <span class="kw">option_string</span> = <span class="st">&#39;-m&#39;</span>

<span class="kw">Processing</span> CustomAction for <span class="st">&quot;positional&quot;</span>
    <span class="kw">parser</span> = 4299616464
    <span class="kw">values</span> = <span class="st">&#39;positional-value&#39;</span>
    <span class="kw">option_string</span> = None

<span class="kw">Namespace</span>(a=<span class="st">&#39;VALUE&#39;</span>, m=[<span class="st">&#39;MULTI-VALUE&#39;</span>], positional=<span class="st">&#39;POSITIONAL-VALUE&#39;</span>)</code></pre></div>
</body>
</html>
